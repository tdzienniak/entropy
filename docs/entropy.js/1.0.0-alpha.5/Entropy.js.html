<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Entropy.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Component.html">Component</a><ul class='methods'><li data-type='method'><a href="Component.html#getType">getType</a></li><li data-type='method'><a href="Component.html#onCreate">onCreate</a></li></ul></li><li><a href="ComponentStore.html">ComponentStore</a><ul class='methods'><li data-type='method'><a href="ComponentStore.html#create">create</a></li><li data-type='method'><a href="ComponentStore.html#free">free</a></li><li data-type='method'><a href="ComponentStore.html#register">register</a></li><li data-type='method'><a href="ComponentStore.html#registerMany">registerMany</a></li></ul></li><li><a href="Engine.html">Engine</a><ul class='methods'><li data-type='method'><a href="Engine.html#addEntity">addEntity</a></li><li data-type='method'><a href="Engine.html#addSystem">addSystem</a></li><li data-type='method'><a href="Engine.html#clear">clear</a></li><li data-type='method'><a href="Engine.html#emit">emit</a></li><li data-type='method'><a href="Engine.html#getEntities">getEntities</a></li><li data-type='method'><a href="Engine.html#off">off</a></li><li data-type='method'><a href="Engine.html#on">on</a></li><li data-type='method'><a href="Engine.html#once">once</a></li><li data-type='method'><a href="Engine.html#removeEntity">removeEntity</a></li><li data-type='method'><a href="Engine.html#removeSystem">removeSystem</a></li><li data-type='method'><a href="Engine.html#startResponding">startResponding</a></li><li data-type='method'><a href="Engine.html#stopResponding">stopResponding</a></li><li data-type='method'><a href="Engine.html#update">update</a></li></ul></li><li><a href="Entity.html">Entity</a><ul class='methods'><li data-type='method'><a href="Entity.html#addComponent">addComponent</a></li><li data-type='method'><a href="Entity.html#onCreate">onCreate</a></li><li data-type='method'><a href="Entity.html#onRemove">onRemove</a></li><li data-type='method'><a href="Entity.html#onReuse">onReuse</a></li><li data-type='method'><a href="Entity.html#removeComponent">removeComponent</a></li></ul></li><li><a href="EntityStore.html">EntityStore</a><ul class='methods'><li data-type='method'><a href="EntityStore.html#create">create</a></li><li data-type='method'><a href="EntityStore.html#free">free</a></li><li data-type='method'><a href="EntityStore.html#register">register</a></li><li data-type='method'><a href="EntityStore.html#registerMany">registerMany</a></li></ul></li><li><a href="Entropy.html">Entropy</a><ul class='methods'><li data-type='method'><a href="Entropy.html#addEntity">addEntity</a></li><li data-type='method'><a href="Entropy.html#addSystem">addSystem</a></li><li data-type='method'><a href="Entropy.html#createComponent">createComponent</a></li><li data-type='method'><a href="Entropy.html#createEntity">createEntity</a></li><li data-type='method'><a href="Entropy.html#createQuery">createQuery</a></li><li data-type='method'><a href="Entropy.html#createSystem">createSystem</a></li><li data-type='method'><a href="Entropy.html#emit">emit</a></li><li data-type='method'><a href="Entropy.html#getEntities">getEntities</a></li><li data-type='method'><a href="Entropy.html#isRunning">isRunning</a></li><li data-type='method'><a href="Entropy.html#off">off</a></li><li data-type='method'><a href="Entropy.html#on">on</a></li><li data-type='method'><a href="Entropy.html#once">once</a></li><li data-type='method'><a href="Entropy.html#pause">pause</a></li><li data-type='method'><a href="Entropy.html#registerComponent">registerComponent</a></li><li data-type='method'><a href="Entropy.html#registerComponents">registerComponents</a></li><li data-type='method'><a href="Entropy.html#registerEntity">registerEntity</a></li><li data-type='method'><a href="Entropy.html#registerEntitys">registerEntitys</a></li><li data-type='method'><a href="Entropy.html#registerSystem">registerSystem</a></li><li data-type='method'><a href="Entropy.html#registerSystems">registerSystems</a></li><li data-type='method'><a href="Entropy.html#removeEntity">removeEntity</a></li><li data-type='method'><a href="Entropy.html#removeSystem">removeSystem</a></li><li data-type='method'><a href="Entropy.html#resume">resume</a></li><li data-type='method'><a href="Entropy.html#start">start</a></li><li data-type='method'><a href="Entropy.html#startResponding">startResponding</a></li><li data-type='method'><a href="Entropy.html#stop">stop</a></li><li data-type='method'><a href="Entropy.html#stopResponding">stopResponding</a></li></ul></li><li><a href="EventEmitter.html">EventEmitter</a><ul class='methods'><li data-type='method'><a href="EventEmitter.html#emit">emit</a></li><li data-type='method'><a href="EventEmitter.html#off">off</a></li><li data-type='method'><a href="EventEmitter.html#on">on</a></li><li data-type='method'><a href="EventEmitter.html#once">once</a></li><li data-type='method'><a href="EventEmitter.html#startResponding">startResponding</a></li><li data-type='method'><a href="EventEmitter.html#stopResponding">stopResponding</a></li></ul></li><li><a href="Query.html">Query</a><ul class='methods'><li data-type='method'><a href="Query.html#addToIndex">addToIndex</a></li><li data-type='method'><a href="Query.html#getEntities">getEntities</a></li><li data-type='method'><a href="Query.html#initialize">initialize</a></li><li data-type='method'><a href="Query.html#removeFromIndex">removeFromIndex</a></li><li data-type='method'><a href="Query.html#satisfiedBy">satisfiedBy</a></li><li data-type='method'><a href="Query.html#shouldUpdate">shouldUpdate</a></li><li data-type='method'><a href="Query.html#update">update</a></li></ul></li><li><a href="SystemStore.html">SystemStore</a><ul class='methods'><li data-type='method'><a href="SystemStore.html#create">create</a></li><li data-type='method'><a href="SystemStore.html#register">register</a></li><li data-type='method'><a href="SystemStore.html#registerMany">registerMany</a></li></ul></li><li><a href="Ticker.html">Ticker</a><ul class='methods'><li data-type='method'><a href="Ticker.html#getFPS">getFPS</a></li><li data-type='method'><a href="Ticker.html#getMaxAllowedFPS">getMaxAllowedFPS</a></li><li data-type='method'><a href="Ticker.html#getSimulationTimestep">getSimulationTimestep</a></li><li data-type='method'><a href="Ticker.html#isRunning">isRunning</a></li><li data-type='method'><a href="Ticker.html#resetFrameDelta">resetFrameDelta</a></li><li data-type='method'><a href="Ticker.html#setMaxAllowedFPS">setMaxAllowedFPS</a></li><li data-type='method'><a href="Ticker.html#setSimulationTimestep">setSimulationTimestep</a></li><li data-type='method'><a href="Ticker.html#start">start</a></li><li data-type='method'><a href="Ticker.html#stop">stop</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="Engine.html#event:clear">clear</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Entropy.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as stampit from 'stampit';
import { isObject } from './helpers';

import EventEmitter from './EventEmitter';
import Engine from './Engine';
import Ticker from './Ticker';
import Query from './Query';

import EntityStore from './EntityStore';
import ComponentStore from './ComponentStore';
import SystemStore from './SystemStore';

const PLUGINS = [];

/**
 * Main framework factory method. This is the only factory, that needs to be called by user.
 *
 * @class Entropy
 * @borrows ComponentStore#register as Entropy#registerComponent
 * @borrows ComponentStore#registerMany as Entropy#registerComponents
 * @borrows ComponentStore#create as Entropy#createComponent
 * @borrows EntityStore#register as Entropy#registerEntity
 * @borrows EntityStore#registerMany as Entropy#registerEntitys
 * @borrows EntityStore#create as Entropy#createEntity
 * @borrows SystemStore#register as Entropy#registerSystem
 * @borrows SystemStore#registerMany as Entropy#registerSystems
 * @borrows SystemStore#create as Entropy#createSystem
 * @extends EventEmitter
 * @param {Object} config
 * @param {Boolean} config.pauseOnVisibilityChange
 *
 * @example
 * const game = Entropy() // creating game with default configuration
 * game.addEntity('Ball', {
 *   x: 0,
 *   y: 0,
 * })
 */
const Entropy = stampit.compose(EventEmitter, {
  statics: {
    stampit,
    registerPlugin(factoryFunction) {
      PLUGINS.push(factoryFunction);
    },
  },
  init(config = {}) {
    // welcome message
    const styles = `
      background: white;
      display: block;
      color: black;
      box-shadow: 1px 1px 3px black;
      padding: 5px;
      text-align: center;
      font-weight: bold;`;

    console.log('%cEntropy 1.0.0-alpha.1 - Entity System Framework for JavaScript', styles);

    /**
     * Stores components for later reuse.
     *
     * @memberof Entropy#
     * @name component
     * @type ComponentStore
     */
    this.component = ComponentStore();

    /**
     * Stores entities for later reuse.
     *
     * @memberof Entropy#
     * @name entity
     * @type EntityStore
     */
    this.entity = EntityStore({
      game: this,
    });

    /**
     *
     * Stores entities for later reuse.
     *
     * @private
     * @memberOf Entropy#
     * @name system
     * @type SystemStore
     */
    this.system = SystemStore({
      game: this,
    });

    /**
     * Instance of {@link Engine}.
     *
     * @memberof Entropy#
     * @name engine
     * @type {Engine}
     */
    this.engine = Engine({
      game: this,
    });

    /**
     * Instance of Ticker class.
     *
     * @memberof Entropy#
     * @name ticker
     * @type {Ticker}
     */
    this.ticker = Ticker({
      game: this,
    });

    // initialize plugins
    PLUGINS.forEach((factoryFunction) => {
      this[factoryFunction.propName] = factoryFunction({
        game: this,
        config: config[factoryFunction.propName],
      });
    });

    // update engine when ticker updates
    this.ticker.on('update', (...args) => this.engine.update(...args));

    // browser only code
    if (typeof window !== 'undefined') {
      // Set the name of the hidden property and the change event for visibility
      let hidden;
      let visibilityChange;

      if (typeof document.hidden !== 'undefined') { // Opera 12.10 and Firefox 18 and later support
        hidden = 'hidden';
        visibilityChange = 'visibilitychange';
      } else if (typeof document.msHidden !== 'undefined') {
        hidden = 'msHidden';
        visibilityChange = 'msvisibilitychange';
      } else if (typeof document.webkitHidden !== 'undefined') {
        hidden = 'webkitHidden';
        visibilityChange = 'webkitvisibilitychange';
      }

      document.addEventListener(visibilityChange, (e) => {
        this.emit('visibilityChange', {
          originalEvent: e,
          hidden: document.hidden,
        });
      }, false);

      if (config.pauseOnHide) {
        this.on('visibilityChange', (e) => {
          if (e[hidden]) {
            this.pause();
          } else {
            this.resume();
          }
        });
      }
    }
  },
  methods: {
    /**
     * Starts the game. See Ticker's {@link Ticker#start} method for more details.
     *
     * @memberof Entropy#
     * @return {Boolean} succesfuly started or not
     */
    start() {
      this.ticker.start();
      this.emit('start');
    },
    /**
     * Pauses the game.
     *
     * @memberof Entropy#
     */
    pause() {
      this.ticker.pause();
    },
    /**
     * Resumes paused game.
     *
     * @memberof Entropy#
     */
    resume() {
      this.ticker.resume();
    },
    /**
     * Stops the game. See Ticker's {@ink Ticker@stop} method for more details.
     *
     * @memberof Entropy#
     * @param {Boolean} clearEngine if `true`, engine will be cleared before ticker stop
     * @return {Entropy} game instance for chaining
     */
    stop(clearEngine) {
      if (clearEngine) {
        this.engine.once('clear', () => this._stopAndEmit());

        // schedule engine clearing
        this.engine.clear();
      } else {
        this._stopAndEmit();
      }
    },
    registerEntity(...args) {
      this.entity.register(...args);

      return this;
    },
    registerEntities(...args) {
      this.entity.registerMany(...args);

      return this;
    },
    createEntity(...args) {
      return this.entity.create(...args);
    },
    /**
     * Adds (or schedules adding) entity to engine. If first argument is entity type (string), then entity instance is created and then added.
     *
     * @public
     * @memberof Entropy#
     * @method addEntity
     * @param {Entity|String} typeOrEntity entity instance or entity type to create
     * @param {...Any}        args         arguments passed to `onCreate` method of entity descriptor, when first argument is entity type
     */
    addEntity(typeOrEntity, ...args) {
      const entity = isObject(typeOrEntity) ?
        typeOrEntity : this.createEntity(typeOrEntity, ...args);

      this.engine.addEntity(entity);

      return this;
    },
    /**
     * Removes (or schedules removing) entity from engine.
     *
     * @public
     * @memberof Entropy#
     * @method removeEntity
     * @param {Entity} entity entity instance
     */
    removeEntity(entity) {
      this.engine.removeEntity(entity);
    },
    registerComponent(...args) {
      this.component.register(...args);

      return this;
    },
    registerComponents(...args) {
      this.component.registerMany(...args);

      return this;
    },
    createComponent(...args) {
      return this.component.create(...args);
    },
    registerSystem(...args) {
      this.system.register(...args);

      return this;
    },
    registerSystems(...args) {
      this.system.registerMany(...args);

      return this;
    },
    createSystem(...args) {
      return this.system.create(...args);
    },
    /**
     * Adds system to engine. If first argument is system type (string), then system instance is created and then added.
     *
     * @public
     * @memberof Entropy#
     * @method addSystem
     * @param {System|String} typeOrSystem system instance or system type to create
     * @param {...Any}        args         arguments passed to `onCreate` method of system descriptor, when first argument is system type
     */
    addSystem(typeOrSystem, ...args) {
      const system = isObject(typeOrSystem) ?
        typeOrSystem : this.createSystem(typeOrSystem, ...args);

      this.engine.addSystem(system);
    },
    /**
     * Removes (or schedules removing) system from engine.
     *
     * @public
     * @memberof Entropy#
     * @method removeSystem
     * @param {System|String} typeOrSystem system instance or system type
     */
    removeSystem(typeOrSystem) {
      this.engine.removeSystem(typeOrSystem);
    },
    /**
     * Creates new query from criterions. See {@link Query} for details about available criterions.
     *
     * @public
     * @memberof Entropy#
     * @method createQuery
     * @param {Object|Array} criterions criterions
     * @returns {Query} query instance
     */
    createQuery(criterions) {
      const query = Query({
        componentsIdsMap: this.component._componentsIdsMap,
        criterions,
      });

      return query;
    },
    /**
     * Returns entities that matches provided query.
     *
     * @public
     * @memberof Entropy#
     * @method getEntities
     * @param {Query} query query
     * @return {Object} object with `length` and `entities` properties
     */
    getEntities(query) {
      return this.engine.getEntities(query);
    },
    /**
     * Checks if ticker is running.
     *
     * @public
     * @memberof Entropy#
     * @method isRunning
     * @returns {Boolean}
     */
    isRunning() {
      return this.ticker.isRunning();
    },
    _stopAndEmit() {
      const stop = this.ticker.stop();

      if (stop) {
        this.emit('stop');
      }
    },
  },
});

module.exports = Entropy;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Fri Dec 23 2016 15:24:05 GMT+0100 (Åšrodkowoeuropejski czas stand.) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
